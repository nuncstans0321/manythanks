<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>這裡有一份可疑的金流...</title>
<style>
  html, body {height:100%; margin:0;}
  body {background:#0b0b0f; color:#d0ffd0; font-family: Calibri, 'Segoe UI', Arial, sans-serif;}
  .wrap { padding:24px; max-width:1280px; margin:0 auto; }
  .panel { background:rgba(10,14,14,.55); border:1px solid #164; border-radius:12px; padding:16px; margin-bottom:16px; box-shadow:0 6px 24px rgba(0,0,0,.25);}
  h1 { margin:0 0 6px; font-size:20px; color:#91f591; }
  .hint { color:#91f591; opacity:.9 }
  .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
  button, input { background:#0f1614; color:#b6ffb6; border:1px solid #2a8a57; padding:8px 12px; border-radius:10px; font-size:14px; }
  button:hover { background:#11211a; cursor:pointer; }
  input[readonly] { background:#0e1412 }
  .chip { display:inline-block; padding:6px 10px; border:1px solid #2a8a57; border-radius:999px; color:#b6ffb6; }
  .hidden { display:none }
  .ok { color:#91f591 }
  .toast { position:fixed; left:50%; transform:translateX(-50%); bottom:20px; background:#0e1614; color:#b6ffb6; border:1px solid #2a8a57; padding:8px 14px; border-radius:999px; box-shadow:0 1px 2px rgba(0,0,0,.28);}

  .excel { border:1px solid #CFCFCF; border-radius:12px; overflow:hidden; background:#ffffff; color:#111; }
  .excel .toolbar { display:flex; align-items:center; gap:10px; padding:8px 10px; border-bottom:1px solid #E6E6E6; background:linear-gradient(#FDFEFE, #F6F7F8); }
  .excel .toolbar .fx { font-weight:700; margin-right:6px; color:#555; }
  .excel .toolbar input { flex:1; border:1px solid #DADCE0; background:#fff; color:#333; }
  .excel .tablewrap { max-height:420px; overflow:auto; position:relative; }
  .excel .tablewrap::-webkit-scrollbar { height: 12px; width: 12px; }
  .excel .tablewrap::-webkit-scrollbar-track { background:#E9F5EA; border-left:1px solid #CDE6D0; }
  .excel .tablewrap::-webkit-scrollbar-thumb { background:#7ED37E; border:2px solid #E9F5EA; border-radius:10px; }
  .excel .tablewrap { scrollbar-color: #7ED37E #E9F5EA; scrollbar-width: auto; }
  .excel .colletters { display:grid; grid-template-columns: 50px 90px 420px 420px 100px 160px; border-bottom:1px solid #E6E6E6; background:#F8FAFB; }
  .excel .colletters div { padding:6px 8px; font-weight:700; color:#555; text-align:center; border-right:1px solid #E6E6E6; }
  .excel .colletters div:last-child { border-right:none; }
  table.tx { width:100%; border-collapse:separate; border-spacing:0; }
  table.tx colgroup col:nth-child(1) { width:50px; }
  table.tx colgroup col:nth-child(2) { width:90px; }
  table.tx colgroup col:nth-child(3) { width:420px; }
  table.tx colgroup col:nth-child(4) { width:420px; }
  table.tx colgroup col:nth-child(5) { width:100px; }
  table.tx colgroup col:nth-child(6) { width:160px; }
  thead th { position:sticky; top:0; z-index:2; background:#E2EFDA; color:#2F6627; font-weight:700; border-bottom:1px solid #C6E0B4; border-right:1px solid #E6E6E6; padding:8px; }
  thead th:last-child { border-right:none; }
  tbody td { border-bottom:1px solid #E6E6E6; border-right:1px solid #E6E6E6; padding:8px; color:#111; background:#fff; }
  tbody td:last-child { border-right:none; }
  tbody tr:hover td { background:#F7FBFF; }
  td.rownum { position:sticky; left:0; background:#FAFAFA; z-index:1; text-align:right; color:#666; }
  td.txid { text-align:center; font-weight:600; color:#222; }
  td.addr { font-family: Consolas, Menlo, Monaco, monospace; font-size:12px; word-break:break-all; line-height:1.2; color:#111; }
  td.amount { text-align:right; font-variant-numeric: tabular-nums; }
  td.time { text-align:center; color:#333; }
  .tail { font-weight:800; color:#0a0; }
  @keyframes blink { 0%,49%{opacity:1} 50%,99%{opacity:.2} 100%{opacity:1} }
  .blink { animation: blink 1s infinite; }

  .codebox { background:#0e1614; border:1px solid #2a8a57; border-radius:10px; padding:12px 14px; color:#b6ffb6; font-weight:700; letter-spacing:.03em; }
</style>
</head>
<body>
<div class="wrap">

  <div class="panel">
    <h1>這裡有一份可疑的金流...</h1>
    <div class="hint">看看這張金流圖有什麼特別之處</div>
  </div>

  <div class="panel excel">
    <div class="toolbar">
      <span class="fx">fx</span>
      <input id="fx" readonly placeholder="公式 / 內容 預覽（滑過任一儲存格查看）" />
      <button id="hint">提示 Hint</button>
    </div>
    <div class="colletters">
      <div></div><div>A</div><div>B</div><div>C</div><div>D</div><div>E</div>
    </div>
    <div class="tablewrap">
      <table class="tx" id="tx">
        <colgroup><col/><col/><col/><col/><col/><col/></colgroup>
        <thead>
          <tr>
            <th>#</th>
            <th>TxID</th>
            <th>From Address</th>
            <th>To Address</th>
            <th>USDT</th>
            <th>Timestamp</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </div>

  <div class="panel" id="qa">
    <p>Q1：有沒有發現金流圖的共同特徵？</p>
    <div class="row">
      <button id="q1-yes">有</button>
      <button id="q1-no">沒有</button>
    </div>
    <div id="q2" class="hidden" style="margin-top:10px;">
      <p>Q2：你覺得它和學員們的座號有關嗎？</p>
      <div class="row">
        <button id="q2-yes">有關</button>
        <button id="q2-no">不確定</button>
      </div>
    </div>
  </div>

  <div class="panel hidden" id="reveal">
    <div class="row"><span class="chip">授權碼</span><span class="hint">（不含 62，依座號由小到大串接）</span></div>
    <div id="code" class="codebox"></div>
    <div class="row" style="margin-top:10px;">
      <button id="copy-code">複製授權碼</button>
    </div>
  </div>

  <div class="panel hidden" id="builder">
    <div class="row"><span class="chip">最後一步</span><span class="hint">把授權碼貼在網址後面，就能進入電子賀卡</span></div>
    <div class="row" style="margin-top:8px;">
      <label>網站根網址：</label>
      <input id="base" value="https://nuncstans0321.github.io/manythanks/" style="min-width:360px" />
      <button id="make">產生完整網址</button>
    </div>
    <div class="row" style="margin-top:8px;">
      <input id="full" readonly style="min-width:520px" placeholder="完整網址將顯示在此…" />
      <button id="open" class="hidden">開啟我們的心意</button>
    </div>
  </div>

</div>

<div id="toast" class="toast hidden">已複製</div>

<script>
const rows = [{"TxID": "TX01", "From": "0x08073a6e86468b4ecd764c501efd3f3478b62017", "To": "0x9a06ba5543a608d7bc586870076a11af91062017", "Amount": "103.7", "Time": "2025-08-01 10:02:00"}, {"TxID": "TX02", "From": "0x9a06ba5543a608d7bc586870076a11af91062017", "To": "0x35101c02e734644db1b2e40ee54d8321d9062018", "Amount": "107.4", "Time": "2025-08-01 10:04:00"}, {"TxID": "TX03", "From": "0x35101c02e734644db1b2e40ee54d8321d9062018", "To": "0xd5e8a27a42c36b31ff94bc28bba647a8ffc62034", "Amount": "111.1", "Time": "2025-08-01 10:06:00"}, {"TxID": "TX04", "From": "0xd5e8a27a42c36b31ff94bc28bba647a8ffc62034", "To": "0x9738652e6de19867ff9e28b520a4cef560862057", "Amount": "114.8", "Time": "2025-08-01 10:08:00"}, {"TxID": "TX05", "From": "0x9738652e6de19867ff9e28b520a4cef560862057", "To": "0x21dc616bb0663a97585d77d90990f299d4762065", "Amount": "118.5", "Time": "2025-08-01 10:10:00"}, {"TxID": "TX06", "From": "0x21dc616bb0663a97585d77d90990f299d4762065", "To": "0x659edfb321d8bf665472f23371d64587a7362071", "Amount": "122.2", "Time": "2025-08-01 10:12:00"}, {"TxID": "TX07", "From": "0x659edfb321d8bf665472f23371d64587a7362071", "To": "0xff454889c35935d4dd669629f9deb7f1f3662079", "Amount": "125.9", "Time": "2025-08-01 10:14:00"}, {"TxID": "TX08", "From": "0xff454889c35935d4dd669629f9deb7f1f3662079", "To": "0xf6b710341beb4f59b8b00ebf089937f5c5262098", "Amount": "129.6", "Time": "2025-08-01 10:16:00"}, {"TxID": "TX09", "From": "0xf6b710341beb4f59b8b00ebf089937f5c5262098", "To": "0xc6fe518d7bead5d9e110dfbfa222fa8247662104", "Amount": "133.3", "Time": "2025-08-01 10:18:00"}, {"TxID": "TX10", "From": "0xc6fe518d7bead5d9e110dfbfa222fa8247662104", "To": "0x98b16756de4e1a49b0fd0f6e1ad1259005762111", "Amount": "137.0", "Time": "2025-08-01 10:20:00"}, {"TxID": "TX11", "From": "0x98b16756de4e1a49b0fd0f6e1ad1259005762111", "To": "0x8da7fea90076051c9169a428599a8fe15c162112", "Amount": "140.7", "Time": "2025-08-01 10:22:00"}, {"TxID": "TX12", "From": "0x8da7fea90076051c9169a428599a8fe15c162112", "To": "0xc694e569eeeecbdbc30042603ea0bf5297562117", "Amount": "144.4", "Time": "2025-08-01 10:24:00"}, {"TxID": "TX13", "From": "0xc694e569eeeecbdbc30042603ea0bf5297562117", "To": "0x3cbfe990773f0e39b38d09a5daaa65612dc62121", "Amount": "148.1", "Time": "2025-08-01 10:26:00"}];

function tdAddr(addr) {
  const head = addr.slice(0, -5);
  const tail = addr.slice(-5);
  return `<span class="head">${head}</span><span class="tail">${tail}</span>`;
}

function setFX(text){ document.getElementById('fx').value = text; }

function renderTable() {
  const tb = document.getElementById('tbody'); tb.innerHTML = '';
  rows.forEach((r, idx) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="rownum xl-cell" data-loc="A${idx+2}">${idx+1}</td>
      <td class="txid xl-cell" data-loc="B${idx+2}">${r.TxID}</td>
      <td class="addr xl-cell" data-loc="C${idx+2}">${tdAddr(r.From)}</td>
      <td class="addr xl-cell" data-loc="D${idx+2}">${tdAddr(r.To)}</td>
      <td class="amount xl-cell" data-loc="E${idx+2}">${r.Amount}</td>
      <td class="time xl-cell" data-loc="F${idx+2}">${r.Time}</td>
    `;
    tb.appendChild(tr);
  });
  document.querySelectorAll('.xl-cell').forEach(td => {
    td.addEventListener('mouseenter', () => setFX(td.innerText.trim()));
    td.addEventListener('mouseleave', () => setFX(''));
  });
}
renderTable();

function doHint() {
  document.querySelectorAll('.tail').forEach(el => {
    el.classList.add('blink');
    el.style.fontWeight='900';
    setTimeout(()=>{ el.classList.remove('blink'); el.style.fontWeight='800'; }, 1800);
  });
}
document.getElementById('hint').onclick = () => doHint();

const qa = document.getElementById('qa');
const q2 = document.getElementById('q2');
const reveal = document.getElementById('reveal');
const builder = document.getElementById('builder');
const openBtn = document.getElementById('open');

document.getElementById('q1-yes').onclick = () => { q2.classList.remove('hidden'); };
document.getElementById('q1-no').onclick = () => { doHint(); };
document.getElementById('q2-yes').onclick = () => { showCode(); };
document.getElementById('q2-no').onclick = () => { doHint(); };

function computeCode() {
  const set = rows.map(r => parseInt(r.To.slice(-3), 10)).sort((a,b)=>a-b);
  return set.join('');
}

function showCode() {
  qa.classList.add('hidden');
  const cd = computeCode();
  document.getElementById('code').textContent = cd;
  reveal.classList.remove('hidden');
}

const toast = document.getElementById('toast');
function showToast(msg){ toast.textContent=msg; toast.classList.remove('hidden'); setTimeout(()=>toast.classList.add('hidden'), 1000); }

document.getElementById('copy-code').onclick = async ()=>{
  try { await navigator.clipboard.writeText(document.getElementById('code').textContent); showToast('授權碼已複製'); }
  catch(e) { showToast('複製失敗'); }
  builder.classList.remove('hidden');
};

document.getElementById('make').onclick = ()=>{
  const base = document.getElementById('base').value.trim();
  const cd = document.getElementById('code').textContent.trim();
  const full = base + cd + '/index.html';
  const fullInput = document.getElementById('full');
  fullInput.value = full;
  if (full.length > 0) openBtn.classList.remove('hidden');
};

openBtn.onclick = ()=>{
  const u = document.getElementById('full').value.trim();
  if(!u) return;
  window.open(u, '_blank');
};
</script>
</body>
</html>
